{
  "hash": "c8c2f1ca3e10ed3ca97101f15f2f824c",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Simulation-Based Hypothesis Testing\"\nsubtitle: \"There Really is Only One Test\"\nauthor: \"Paul Johnson\"\n---\n\n\n\n\n\n# Hypothesis Testing {data-background-color=\"#425563\" data-verticator=\"#E8EDEE\"}\n\nIssues of Significance\n\n## What is a Hypothesis? {.center}\n\n- A falsifiable statement about the world that forms the basis for scientific enquiry.\n- A hypothesis posits the effect we expect to observe in our sample data, in order to make generalisable statements about the effect in the population.\n- Hypotheses are derived from theories -- what we should expect to observe in our data, given the theory.\n- Quantitative research seeks to test hypotheses, and the results are a step closer to drawing inferences about the world.\n\n## Hypothesis Testing {.center}\n\n- Hypothesis tests measure the compatibility of the observed data with what we should observe if the hypothesis (and all other assumptions of the test) is true.\n- A hypothesis test quantifies our confidence that what we observe in the sample did not occur by chance (and is therefore generalisable to the population)\n- The Null Hypothesis Significance Testing (NHST) framework is the most common approach to testing hypotheses.\n    - Null Hypothesis ($H_0$) = No effect in the population\n    - Alternative Hypothesis ($H_1$) = The effect in the population is not equal to zero\n- A hypothesis test in NHST seeks to reject the null, which provides support for (but does not confirm) the alternative hypothesis.\n- NHST is controversial, but it is pervasive across science.\n\n## A Common Testing Framework {.center}\n\n1. Set test (often null) hypothesis.\n2. Generate test distribution -- the data distribution we should expect to observe if test hypothesis is true (and all other assumptions met).\n3. Compute test statistic -- quantifying how extreme the observed data distribution is given the test distribution.\n3. Compute p-value -- quantifying the probability of observing a test statistic as large or larger if test hypothesis is true.\n\n## One-Sample T-Test\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(42)\n\niq_scores <- \n  tibble(score = rnorm(50, mean = 105, sd = 15))\n\nt_test(\n  iq_scores, response = score, \n  mu = 100, alternative = \"greater\"\n  ) |> \n  mutate(\n    across(where(is.numeric), ~round(.x, 2))\n    ) |>\n  gt::gt()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"rxqrenhwhu\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#rxqrenhwhu table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#rxqrenhwhu thead, #rxqrenhwhu tbody, #rxqrenhwhu tfoot, #rxqrenhwhu tr, #rxqrenhwhu td, #rxqrenhwhu th {\n  border-style: none;\n}\n\n#rxqrenhwhu p {\n  margin: 0;\n  padding: 0;\n}\n\n#rxqrenhwhu .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#rxqrenhwhu .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#rxqrenhwhu .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#rxqrenhwhu .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#rxqrenhwhu .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#rxqrenhwhu .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#rxqrenhwhu .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#rxqrenhwhu .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#rxqrenhwhu .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#rxqrenhwhu .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#rxqrenhwhu .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#rxqrenhwhu .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#rxqrenhwhu .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#rxqrenhwhu .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#rxqrenhwhu .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#rxqrenhwhu .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#rxqrenhwhu .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#rxqrenhwhu .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#rxqrenhwhu .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#rxqrenhwhu .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#rxqrenhwhu .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#rxqrenhwhu .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#rxqrenhwhu .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#rxqrenhwhu .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#rxqrenhwhu .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#rxqrenhwhu .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#rxqrenhwhu .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#rxqrenhwhu .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#rxqrenhwhu .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#rxqrenhwhu .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#rxqrenhwhu .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#rxqrenhwhu .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#rxqrenhwhu .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#rxqrenhwhu .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#rxqrenhwhu .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#rxqrenhwhu .gt_left {\n  text-align: left;\n}\n\n#rxqrenhwhu .gt_center {\n  text-align: center;\n}\n\n#rxqrenhwhu .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#rxqrenhwhu .gt_font_normal {\n  font-weight: normal;\n}\n\n#rxqrenhwhu .gt_font_bold {\n  font-weight: bold;\n}\n\n#rxqrenhwhu .gt_font_italic {\n  font-style: italic;\n}\n\n#rxqrenhwhu .gt_super {\n  font-size: 65%;\n}\n\n#rxqrenhwhu .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#rxqrenhwhu .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#rxqrenhwhu .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#rxqrenhwhu .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#rxqrenhwhu .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#rxqrenhwhu .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#rxqrenhwhu .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#rxqrenhwhu .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#rxqrenhwhu div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"statistic\">statistic</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"t_df\">t_df</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"p_value\">p_value</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"alternative\">alternative</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"estimate\">estimate</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"lower_ci\">lower_ci</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"upper_ci\">upper_ci</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"statistic\" class=\"gt_row gt_right\">1.83</td>\n<td headers=\"t_df\" class=\"gt_row gt_right\">49</td>\n<td headers=\"p_value\" class=\"gt_row gt_right\">0.04</td>\n<td headers=\"alternative\" class=\"gt_row gt_left\">greater</td>\n<td headers=\"estimate\" class=\"gt_row gt_right\">104.46</td>\n<td headers=\"lower_ci\" class=\"gt_row gt_right\">100.37</td>\n<td headers=\"upper_ci\" class=\"gt_row gt_right\">Inf</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n## A Test for Every Eventuality {.center}\n\n- T-tests (one sample, paired, two-samples)\n- Chi-squared tests\n- ANOVA\n- Mann-Whitney u-test\n- Wilcoxon signed rank test\n- Fisher exact test\n- McNemar test\n- Kruskal-Wallis test\n- And probably thousands more...\n\n# THERE MUST BE A BETTER WAY {data-background-color=\"#425563\" data-verticator=\"#E8EDEE\"}\n\n## Simulation-Based Hypothesis Tests {.center}\n\n![](/man/figures/simulation_tests.png)\n\n## Simulating the Common Testing Framework {.center}\n\n- All hypothesis tests are trying to do the same thing -- compare the observed data against a test distribution.\n- We can leverage this and, instead, simulate the data distribution that our test hypothesis should produce.\n- We just need a test statistic (a measurement of the size of the effect, like absolute difference in means), our test/null hypothesis and a model for generating a distribution from it, and a method for computing the p-value [@downey2016].\n\n## Simulating a T-Test {.center}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nt <- \n  iq_scores |> \n  specify(response = score) |> \n  calculate(stat = \"mean\")\n\nnull <- \n  iq_scores |>\n  specify(response = score) |> \n  hypothesize(null = \"point\", mu = 100) |> \n  generate(reps = 1000, type = \"bootstrap\") |> \n  calculate(stat = \"mean\")\n\np <- null |> get_p_value(obs_stat = t, direction = \"greater\")\n\nnull |>\n  visualize() + \n  shade_p_value(t, direction = NULL, color = \"#00A499\") +\n  geom_hline(yintercept = 0, colour = \"#333333\", linewidth = 1) +\n  annotate(\n    \"text\", x = 95, y = 125, \n    label = paste0(\"t = \", round(t, 2), \"\\n p = \", round(p, 2)),\n    size = rel(6), color=\"grey30\"\n    ) +\n  labs(x = \"IQ Score\", y = NULL, title = NULL)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-revealjs/unnamed-chunk-3-1.png){width=1800}\n:::\n:::\n\n\n\n## Further Resources {.center}\n\n- [{infer}](https://infer.tidymodels.org)\n- [There is Still Only One Test](https://allendowney.substack.com/p/there-is-still-only-one-test)\n- [Elements of Data Science - Hypothesis Testing](https://allendowney.github.io/ElementsOfDataScience/13_hypothesis.html)\n- [The Permutation Test](https://www.jwilber.me/permutationtest/)\n\n# Thank You!\n\nContact:\n<br>\n\n<ul >\n{{< fa solid envelope >}} [paul.johnson50@nhs.net](mailto: paul.johnson50@nhs.net)\n</ul>\n\n\nCode & Slides:\n<br>\n\n<ul >\n{{< fa brands github >}}[/NHS-South-Central-and-West/linear-regression-from-scratch](https://github.com/nhs-south-central-and-west/simulation-based-tests)\n</ul>\n\n## References\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}